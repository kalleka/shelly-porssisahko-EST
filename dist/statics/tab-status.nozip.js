{let f=[0,0],g=-1,u='<tr><td colspan="3">Hetkel teadmata</td></tr>';var e=async()=>{try{if(void 0!==state){if(!state)throw Error("no data");let l=state,c=l.s,T=l.c;var t=0<l.p.length,e=(document.title=`${c.dn?c.dn+" - ":""}Börsielekter`,qs("#s-cmd").innerHTML=c.cmd?"SEES":"VÄLJAS",qs("#s-cmd").style.color=c.cmd?"green":"red",qs("#s-mode").innerHTML=MODE_STR[T.mode],qs("#s-dn").innerHTML=c.dn||"<i>Pole seadistatud</i>",qs("#s-now").innerHTML=t?c.p[0].now.toFixed(2)+" c/kWh":"",qs("#s-st").innerHTML=(9===c.st?STATE_STR[c.st].replace("%s",formatDateTime(new Date(1e3*c.fCmdTs),!1)):STATE_STR[c.st])+(T.inv?" (vastupidine)":""),""!=c.str&&(qs("#s-st").innerHTML+="<br><br>"+c.str),qs("#s-info").innerHTML=`${0<c.chkTs?"Väljundi olek kontrollitud "+formatTime(new Date(1e3*c.chkTs)):"Kontrollime olekut..."} - `+(0<c.p[0].ts?"Hinnad uuendatud "+formatTime(new Date(1e3*Math.max(c.p[0].ts,c.p[1].ts))):"Uuendame hindu..."),qs("#s-v").innerHTML=`Käivitatud ${formatDateTime(new Date(1e3*c.upTs))} (käigus ${(((new Date).getTime()-new Date(1e3*c.upTs).getTime())/1e3/60/60/24).toFixed("1")} päeva) - versioon `+c.v,(e,t)=>{var s='<tr><td class="t bg">Keskmine</td><td class="t bg">Soodsaim</td><td class="t bg">Kalleim</td></tr>';return 0==e.ts?s+u:s+`
        <tr>
          <td>${e.avg.toFixed(2)} c/kWh</td>
          <td>${e.low.toFixed(2)} c/kWh</td>
          <td>${e.high.toFixed(2)} c/kWh</td>
        </tr>`}),s=(qs("#s-pi0").innerHTML=e(c.p[0]),qs("#s-pi1").innerHTML=e(c.p[1]),(n,d)=>{var e=' <tr><td class="t bg">Aeg</td><td class="t bg">Hind</td><td class="t bg">Lülitus</td></tr>',m=[];if(0!=c.p[n].ts){if(2===T.mode){var t=T.m2.per<0?1:T.m2.per;for(let e=0;e<l.p[n].length;e+=t){var i=-2==T.m2.per&&1<=e?T.m2.cnt2:T.m2.cnt;if(!(i<=0)){var o=[];let t=e,s=e+T.m2.per;T.m2.per<0&&0==e?(t=T.m2.ps,s=T.m2.pe):-2==T.m2.per&&1==e&&(t=T.m2.ps2,s=T.m2.pe2);for(let e=t;e<s&&!(e>l.p[n].length-1);e++)o.push(e);if(T.m2.sq){let e=999,r=0;for(let s=0;s<=o.length-i;s++){let t=0;for(let e=s;e<s+i;e++)t+=l.p[n][o[e]][1];t/i<e&&(e=t/i,r=s)}for(let e=r;e<r+i;e++)m.push(o[e])}else{let t=0;for(let e=1;e<o.length;e++){var r=o[e];for(t=e-1;0<=t&&l.p[n][r][1]<l.p[n][o[t]][1];t--)o[t+1]=o[t];o[t+1]=r}for(let e=0;e<i;e++)m.push(o[e])}if(-1==T.m2.per||-2==T.m2.per&&1<=e)break}}}if(f[n]!==c.p[n].ts||0==n&&g!==(new Date).getHours()){let s=0,r=!(d.innerHTML=e);for(let t=0;t<l.p[n].length;t++){var a=l.p[n][t],p=new Date(1e3*a[0]);let e=(0===T.mode&&T.m0.cmd||1===T.mode&&a[1]<=("avg"==T.m1.lim?c.p[n].avg:T.m1.lim)||2===T.mode&&m.includes(t)&&a[1]<=("avg"==T.m2.m?c.p[n].avg:T.m2.m)||2===T.mode&&a[1]<=("avg"==T.m2.lim?c.p[n].avg:T.m2.lim)||(T.fh&1<<t)==1<<t&&(T.fhCmd&1<<t)==1<<t)&&!((T.fh&1<<t)==1<<t&&0==(T.fhCmd&1<<t));T.inv&&(e=!e),2===T.mode&&(T.m2.per<0&&(t==T.m2.ps||t==T.m2.pe)||-2==T.m2.per&&(t==T.m2.ps2||t==T.m2.pe2)||0<T.m2.per&&t>=s+T.m2.per)&&(s+=T.m2.per,r=!r),d.innerHTML+=`<tr style="${p.getHours()==(new Date).getHours()&&0==n?"font-weight:bold;":""}${r?"background:#ededed;":""}">
            <td class="fit">${formatTime(p,!1)}</td>
            <td>${a[1].toFixed(2)} c/kWh</td>
            <td>${e?"&#x2714;":""}</td>
            </tr>`}0==n&&(g=(new Date).getHours()),f[n]=c.p[n].ts}return c.p[n].ts}d.innerHTML=e+u});s(0,qs("#s-p0")),s(1,qs("#s-p1"))}}catch(e){console.error(e);t=e=>qs(e).innerHTML="";qs("#s-cmd").innerHTML="Info puudub",qs("#s-cmd").style.color="red",t("#s-dn"),t("#s-now"),t("#s-mode"),t("#s-p0"),t("#s-pi0"),t("#s-p1"),t("#s-pi1"),t("#s-info"),t("#s-st")}};e(),CBS.push(e)}